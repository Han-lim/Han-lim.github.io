---
published: true
title:  "[Paper Review] FCOS3D: Fully Convolutional One-Stage Monocular 3D Object Detection"
categories:
  - 3d_object_detection
tags:
  - [3D_Object_Detection, Computer_Vision, Deep_Learning, Paper_Review]

toc: true
toc_sticky: true
 
date: 2022-06-24
last_modified_at: 2020-06-24
---


논문 정보: Wang, T., Zhu, X., Pang, J., & Lin, D. (2021). Fcos3d: Fully convolutional one-stage monocular 3d object detection. In Proceedings of the IEEE/CVF International Conference on Computer Vision
 (pp. 913-922).


----
## Abstract
본 논문에서는, fully convolutional single-stage detector 구조를 활용하는 기존 방식으로 이 문제를 연구하고, general framework FCOS 3D를 제안하였습니다.  
전체적인 pipeline은,  
 (1) 먼저 7-DoF 3D target들을 image domain으로 transform 한 후,  
 (2) transform한 target들을 2D와 3D attribute으로 decouple  
 (3) object들을 2D scale에 따라 서로 다른 feature level로 만든 후,  
 (4) projected 3D-center에 대해서만 위 결과를 assign

center-ness는 3D target formulation 에 맞추기 위해 3D-center 기반 2D Gaussian distribution으로 다시 정의합니다. 이러한 framework은 단순하지만, 효율적으로 이전처럼 2D detector나 2D-3D correspondence 단계를 없앴습니다. 또한, NeurIPS 2020 challenge에서 1위를 달성했습니다.

----
## Introduction

monocular 3D object detection의 가장 쉬운 solution은 2D domain의 방식을 그대로 따르고, 보조 3D attibute들을 예측하기 위한 extra component를 추가하는 것입니다.  

이전 논문들 중 [30, 20]은 2D box 예측을 유지하고, 거기에 2D center들과 regions of interest에 대해 3D attribute들을 regress 하는 방식이다. [1, 9, 2]는 각 2D  anchor들에 해당하는 3D priors를 사용하여 2D와 3D box들을 동시에 예측한다.  

> [30] Andrea Simonelli, Samuel Rota Rota Bulo, Lorenzo Porzi, 
Manuel Lopez-Antequera, and Peter Kontschieder. Disentangling monocular 3d object detection. In IEEE International Conference on Computer Vision, 2019.  
> [20] Fabian Manhardt, Wadim Kehl, and Adrien Gaidon. Roi10d: Monocular lifting of 2d detection to 6d pose and metric
shape. In IEEE Conference on Computer Vision and Pattern
Recognition, 2019.  
> [1] Garrick Brazil and Xiaoming Liu. M3d-rpn: Monocular 3d
region proposal network for object detection. In IEEE International Conference on Computer Vision, 2019.  
> [9] Mingyu Ding, Yuqi Huo, Hongwei Yi, Zhe Wang, Jianping
Shi, Zhiwu Lu, and Ping Luo. Learning depth-guided convolutions for monocular 3d object detection. In IEEE Conference on Computer Vision and Pattern Recognition, 2020.  
> [2] Garrick Brazil, Gerard Pons-Moll, Xiaoming Liu, and Bernt
Schiele. Kinematic 3d object detection in monocular video.
In Proceedings of the European Conference on Computer Vision, 2020.  

<br></br>
3D Object Detection에서 해결해야 할 문제는 2D-3D correspondence로 3D target을 2D domain에 할당하고 나중에 예측을 하는 방식을 어떻게 할 것인가 입니다.  
본 논문에서는, 단순하지만 효과적으로 2D detector로 3D localization을 예측했습니다.  

FCOS3D Pipeline) 
1. 2D image 상에 7-DoF 3D locations를 project한 후, project된 center point를 3D-center라고 정의 
> 이 projection을 통해, 3D-center는 2.5D의 정보(2D location과 그에 해당하는 depth)를 갖게 됨.
2.  2D location은 image의 특정 지점에서 2D offset으로 더 줄일 수 있으며, 이는 2D detection에서와 같이 서로 다른 feature level 사이에서 normalize 시킬 수 있는 유일한 2D attribute 역할을 함. 그와 달리, depth, 3D size, orientation은 decoupling 이후의 3D attribute이 됨. 
> 이 방법으로, 3D target들을 center-based paradigm으로 변환하여, 이전 방식인 2D detection이나 2D-3D correspondence를 적용하지 않아도 됨. 

구현은 이름처럼 FCOS를 기반으로 하였습니다.  
FCOS에 대해 간단히 설명하자면, FCOS는 simple anchor-free fully convolutional single-stage detector 입니다.  
가장 먼저, object들을 2D scale을 고려하여 서로 다른 feature level(P3 ~ P7)로 생성합니다.  
그런 다음, 각 training sample의 regression target들을 일치하는 projected 3D center에만 assign합니다.  
FCOS와 FCOS3D의 차이점은 FCOS는 center-ness를 boundary의 distance로 나타낸 반면, FCOS 3D는 3D-center를 기반으로 한 2D 가우시안 분포로 3D center-ness를 표현합니다.

----
## Approach
다룰 내용

1. framework의 overview
2. task에 맞게 수정된 2D guided multi-level 3D prediction과 3D center-ness with 2D Gaussian distribution에 해당하는 technical design에 대한 설명



Paper Link: <https://arxiv.org/pdf/2104.10956.pdf>
